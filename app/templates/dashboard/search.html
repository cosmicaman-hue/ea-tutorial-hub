{% extends "base.html" %}

{% block title %}Search Results - EA Tutorial Hub{% endblock %}

{% block content %}
<div class="container my-5">
    <form class="mb-5" method="GET" action="{{ url_for('dashboard.search') }}">
        <div class="row g-2">
            <div class="col-12 col-md-8">
                <input type="text" name="q" class="form-control form-control-lg" placeholder="Search notes, quizzes..." value="{{ query }}">
            </div>
            <div class="col-12 col-md-2">
                <select name="category" class="form-select form-select-lg">
                    <option value="all" {% if category == 'all' %}selected{% endif %}>All</option>
                    <option value="notes" {% if category == 'notes' %}selected{% endif %}>Notes</option>
                    <option value="quizzes" {% if category == 'quizzes' %}selected{% endif %}>Quizzes</option>
                </select>
            </div>
            <div class="col-12 col-md-2">
                <button type="submit" class="btn btn-primary w-100">Search</button>
            </div>
        </div>
    </form>

    {% if query %}
        <h3>Search Results for "{{ query }}"</h3>

        {% if results.notes %}
        <div class="mb-5">
            <h5>Notes ({{ results.notes|length }})</h5>
            <div class="row">
                {% for note in results.notes %}
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">{{ note.title }}</h5>
                            <p class="card-text text-muted small">{{ note.subject }} | {{ note.class_level }}</p>
                            <p class="card-text">{{ note.description[:80] }}...</p>
                            <a href="{{ url_for('notes.view', note_id=note.id) }}" class="btn btn-sm btn-outline-primary">
                                View <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if results.quizzes %}
        <div class="mb-5">
            <h5>Quizzes ({{ results.quizzes|length }})</h5>
            <div class="row">
                {% for quiz in results.quizzes %}
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">{{ quiz.title }}</h5>
                            <p class="card-text text-muted small">{{ quiz.subject }} | {{ quiz.class_level }}</p>
                            <p class="card-text">{{ quiz.description[:80] }}...</p>
                            <a href="{{ url_for('quiz.view', quiz_id=quiz.id) }}" class="btn btn-sm btn-outline-success w-100">
                                <i class="fas fa-play"></i> Start
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if not results.notes and not results.quizzes %}
        <div class="alert alert-info">
            <i class="fas fa-info-circle"></i> No results found for your search. Try different keywords.
        </div>
        {% endif %}
    {% else %}
        <div class="alert alert-warning">
            <i class="fas fa-search"></i> Enter search terms to find notes and quizzes.
        </div>
    {% endif %}
</div>
{% endblock %}
